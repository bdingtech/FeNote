---
description: HTTP协议承担成浏览器与服务器之间的通信，是互联网世界的基石，也是浏览器中最重要且使用最多的协议
---

# 01即将完成使命的HTTP/1

## 为知识共享而诞生

1989 年 3 月，互联网还只属于少数人。在这一互联网的黎明期， HTTP 诞生了。

CERN\(欧洲核子研究组织\)的蒂姆 • 伯纳斯 - 李\(Tim Berners- Lee\)博士提出了一种能让远隔两地的研究者们共享知识的设想。

最初设想的基本理念是:借助多文档之间相互关联形成的超文本 \(HyperText\)，连成可相互参阅的 WWW\(World Wide Web，万维网\)。

![HTTP&#x7684;&#x57FA;&#x672C;&#x6D41;&#x7A0B;](../../../.gitbook/assets/image%20%2890%29.png)

## 缝缝补补的HTTP/1.1（目前使用最多）

### 1.增加长连接技术

HTTP 无论是那个版本，都是基于TCP传输的，而TCP的连接需要经过三次握手和四次挥手，而HTTP/1.0中的每一个HTTP请求都会重新经历这个过程，对于小文件传输，而且页面上的引用的东西不多时，这种传输方式还没有什么大问题，但是随着时代的发展，网页上的资源越来越多，传输的文件越来越大，如果再采用这种方式就会带来不必要的性能浪费，和时间开销

![HTTP/1.0&#x8BF7;&#x4F20;&#x8F93;&#x65B9;&#x5F0F;](../../../.gitbook/assets/image%20%2891%29.png)

HTTP/1.1 中增加了长连接的的方法，它的特点是在一个 TCP 连接上可以传输多个 HTTP 请求，只要浏览器或者服务器没有明确断开连接，那么该 TCP 连接会一直保持。**且浏览器默认开启TCP长连接，如果不想使用长连接的话，需要显示的添加Connection:closed请求头**

![HTTP1.1&#x7684;&#x957F;&#x8FDE;&#x63A5;&#x65B9;&#x5F0F;](../../../.gitbook/assets/image%20%2888%29.png)

### 2.增加管线化技术（失败\)

长连接技术虽然能够减少TCP的建立与断开次数，但是基于HTTP的**一发一收**机制，下一个请求必须等到上一个请求接收到后才能发送，如果TCP通道中的某个请求因为某些原因没有及时返回，那么这时候就会阻塞后面的所有请求，这就是著名的**队头阻塞**。

HTTP/1.1试图采用管线化技来，解决队头阻塞，但是因为HTTP管道化本身可能会导致队头阻塞的问题，**现代浏览器默认都关闭了管道化，并且大部分服务器也是默认不支持管道化的**。

![](../../../.gitbook/assets/image%20%2893%29.png)

因为，现在浏览器都没有采用这种技术，所以这里不再详细深入了

## HTTP1.1如何解决队头阻塞

### 增加并发连接

RFC2616中明确先试试每个客户端（域名为单位）可以建立两个长连接。

但是一般浏览器会把并发连接增加到6个或者8个，Chrome 就是6个，也就是页面中如果针对同一个域名有多个http请求，谷歌浏览器会针对这个域名建立6个tcp长连接，在每个长连接里面再去处理http请求，但是这种方案其实对服务器的挑战非常大

![http1.0&#x65F6;&#x4EE3;&#xFF1A;100&#x4E2A;http&#x8BF7;&#x6C42;&#x5EFA;&#x7ACB;100&#x4E2A;tcp&#x8FDE;&#x63A5;&#x3002;](../../../.gitbook/assets/image%20%2889%29.png)

![http1.1&#x65F6;&#x4EE3;&#xFF0C;tcp&#x652F;&#x6301;&#x4E86;&#x957F;&#x8FDE;&#x63A5;&#xFF0C;&#x6BCF;&#x4E2A;tcp&#x53EF;&#x4EE5;&#x5904;&#x7406;&#x591A;&#x4E2A;http&#x8BF7;&#x6C42;&#x3002;](../../../.gitbook/assets/image%20%2892%29.png)

### 2.域名分片

一个域名不是可以并发 6 个长连接吗？那我就多分几个域名。

比如 content1.sanyuan.com 、content2.sanyuan.com。

这样一个`sanyuan.com`域名下可以分出非常多的二级域名，而它们都指向同样的一台服务器，能够并发的长连接数更多了，事实上也更好地解决了队头阻塞的问题。

