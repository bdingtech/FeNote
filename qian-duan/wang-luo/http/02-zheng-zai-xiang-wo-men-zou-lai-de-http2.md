---
description: 时代在不断地发展，人们对信息的传达有了更高的要求，而HTTP/1.1已经不太符合时代的要求了，所以我们需要升级协议，以适应更加复杂的场景和要求
---

# 02正在向我们走来的HTTP/2

目前主流的 HTTP/1.1 标准，自 1999 年发布的 RFC2616 之后再未 进行过改订。SPDY 和 WebSocket 等技术纷纷出现，很难断言 HTTP/1.1 仍是适用于当下的 Web 的协议。

负责互联网技术标准的 IETF\(Internet Engineering Task Force，互 联网工程任务组\)创立 httpbis\(Hypertext Transfer Protocol Bis，http:// datatracker.ietf.org/wg/httpbis/\)工作组，其目标是推进下一代 HTTP—— HTTP/2.0 在 2014 年 11 月实现标准化。

由于 HTTPS 在安全方面已经做的非常好了，HTTP 改进的关注点放在了性能方面。对于 HTTP/2 而言，它对于性能的提升主要在于两点:

* 头部压缩
* 多路复用

当然还有一些颠覆性的功能实现:

* 设置请求优先级
* 服务器推送

**这些重大的提升本质上也是为了解决 HTTP 本身的问题而产生的**。接下来我们来看看 HTTP/2 解决了哪些问题，以及解决方式具体是如何的。

## 多路复用

前文我们提到了，HTTP/1.1试图采用管线化技术来解决队头阻塞的问题，但是最终还是失败了，所以在HTTP/2.0中，我们急需解决的就是这个问题，HTTP/2 也给出了满意的答案——**多路复用**

回顾http1.1协议，我们了解到，虽然http1.1实现了tcp的长连接，在一个tcp链接通道中，我们可以连续处理多个http请求响应，但是这个处理过程是半双工模式，也就是同一时刻只能处理一个request的请求或者响应，后面的request必须等到前面的请求响应之后才能进行。

http2完全摒弃http1.1半双工通信的方式，实现了全双工通信，具体表现为：浏览器针对同一个域名的资源，只建立一个tcp连接通道，所有的针对这个域名的请求全部在这个通道中完成，并且引入了流的机制，这条通道可以同时处理多个request，这不同于http1.1的pepeline，http2的多路复用，对于request的响应并不会因为上一个request的响应未完成而阻塞，http2彻底解决了[http层面的队头阻塞](http://mp.weixin.qq.com/s?__biz=MzA4MTg4MDI5OQ==&mid=2456039530&idx=1&sn=3d94daa896d4573273b3575fcda8bc7a&chksm=881ea5eebf692cf8957cffa3506837ced7f1ecd47f5ba0d21bb89c0d7a1bf972d40c3060357f&scene=21#wechat_redirect)。

![http2&#x57FA;&#x4E8E;&#x6D41;&#x6765;&#x4F20;&#x8F93;](../../../.gitbook/assets/image%20%2894%29.png)

上图中每个大的蓝色方块代表一个http的request，每个request被切割为多个fream，并且被编号，我们用黄红绿三种颜色分别代表三个stream流，不同的颜色代表不同的streamid，http2接收到数据会根据其streamid自动还原数据，这样就实现了在一个TCP连接通道中的流式传输，多个request都会复用这个TCP通道，实现了高效的复用。

多路复用代替原来的序列和阻塞机制。所有就是请求的都是通过一个 TCP 连接并发完成。因为在多路复用之前所有的传输是基于基础文本的，在多路复用中是基于二进制数据帧的传输、消息、流，所以可以做到乱序的传输。多路复用对同一域名下所有请求都是基于流，所以不存在同域并行的阻塞。多次请求如下图：

![](../../../.gitbook/assets/image%20%2892%29.png)

## 头部压缩

简单来说就是对头部的请求字段进行压缩

具体实施方式如下

首先是在服务器和客户端之间建立哈希表，将用到的字段存放在这张表中，那么在传输的时候对于之前出现过的值，只需要把**索引**\(比如0，1，2，...\)传给对方即可，对方拿到索引查表就行了。这种**传索引**的方式，可以说让请求头字段得到极大程度的精简和复用

![](../../../.gitbook/assets/image%20%2889%29.png)

{% hint style="info" %}
HTTP/2 当中废除了起始行的概念，将起始行中的请求方法、URI、状态码转换成了头字段，不过这些字段都有一个":"前缀，用来和其它请求头区分开。
{% endhint %}

最后可以打开HTTP2图片加载测试网站，感受一下HTTP/2的魅力！

[HTTP/2测试](https://http2.akamai.com/demo)

