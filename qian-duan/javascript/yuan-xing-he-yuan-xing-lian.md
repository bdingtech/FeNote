---
description: 花了六个多小时看了一下JavaScript高级程序设计中原型这一块的论述，感觉受益匪浅，现在在这里总结做一下笔记，便于日后复习
---

# 原型链和继承

JavaScript中引入了原型与原型链的概念，通过这种共享关系，使得所有对象都能共享原型的方法，**节省内存，**而又通过继承关系，通过制定不同的原型，又能很好的模**拟「类」的行为**。

## 聊一聊变量提升

在JavaScript代码执行之前，会有一个预编译的过程，编译阶段的一个工作是找到所有的声明，所以包括变量和函数在内的所有声明会进行处理，这个过程称之为变量提升

例如 `var a = 2`, 当我们看到这一行代码时，可能就认为这是一个声明，再平淡无过了，但是编译器并不会这么认为，实际上，会比看成是两个声明，`var a` 和 `a = 2`，第一个定义声明是在编译阶段进行的，第二个赋值声明会被**保留在原地等待执行阶段** 

考虑一下代码

```javascript
//原始代码
a = 2;
var a; //在编译阶段发生变量提升
console.log( a );

//编译器处理后的代码
var a;
a = 2;
console.log( a );
```

由于有变量提升的这种机制, a 被正常的定义和赋值，所以最后的结果为 2

再考虑另外一段代码

```javascript
//原始代码
console.log( a );
var a = 2;

//编译器处理后的代码
var a;
console.log( a );
a = 2 //留在原地
```

变量提升，提升的是变量的声明，而赋值操作或其他运行逻辑会停留在原地，等待执行

## 作用域和闭包

> 闭包就好像从 JavaScript 中分离出来的一个充满神秘色彩的未开化世界，只有最勇敢的人 才能够到达那里。——《你不知道的JavaScript 上卷》

### 说一说JavaScript中的作用域

#### 全局作用域

#### 函数作用域

#### 块级作用域

### 闭包是什么？

闭包是一种能够在函数声明过程中将**环境信息（父函数的作用域）**与**所属函数**绑定在一起的**数据结构**

```javascript
function makeAddFunction(amount){
    function add(number){
        return number + amount
    }
    return add
}
```

```javascript
//利用闭包实现一个计数器
let test = (function count(){
    let num = 0
    function addNum(){
        num++
        console.log(num)
    }
    return addNum
})()
test() //1
test() //2
test() //3
```

### 在日常开发中，闭包有一些什么实际用途？

> 我就不班门弄斧了，这里引用 《JavaScript函数式编程指南》中的总结

1. **模拟私有变量**，可以通过闭包这种数据结构将一些变量和方法隐藏起来，外界不能访问
2. **提供模块化开发机制**
3. **创建块级作用域**

## 什么是原型

在介绍原型之前，我们先要了解两个ECMA规范

#### 1.每个函数都会自动的创建一个 `Prototype` 属性

![prototype](../../.gitbook/assets/image%20%2828%29%20%281%29.png)

#### 2.所有的 Object 都有一个默认的隐式引用

> Every object has an implicit reference \(called the object's prototype\)

![\_\_proto\_\_](../../.gitbook/assets/image%20%2829%29.png)

好了现在我们知道有两种类型的原型了，一种是函数中的 `prototype` _显式原型_，另一种是对象中_隐式原型，_由这两种原型模型组成 JavaScript 强大的共享机制，在 JavaScript 语言中并不支持类与继承，但是通过原型特性，我们可以模拟继承。

继承是 OO 语言中的一个最为人津津乐道的概念。许多 OO 语言都支持两种继承方式：接口继承和实现继承。接口继承只继承方法签名，而实现继承则继承实际的方法。如前所述，由于函数没有签名，在 ECMAScript 中无法实现接口继承。ECMAScript 只支持实现继承，而且其实现继承主要是依靠原型链来实现的。







